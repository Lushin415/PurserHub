# PurserHub - Quick Start Guide

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **PurserHub** ‚Äî –≥–ª–∞–≤–Ω—ã–π Telegram –±–æ—Ç (–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä)
- **workers-service** ‚Äî –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ü–í–ó (–ø–æ—Ä—Ç **8002**)
- **realty-monitor** ‚Äî –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ (–ø–æ—Ä—Ç **8009**)

–í—Å–µ —Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞ —Å–≤—è–∑–∞–Ω—ã —á–µ—Ä–µ–∑ Docker network –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **shared volume** –¥–ª—è Pyrogram —Å–µ—Å—Å–∏–π.

---

## –ó–∞–ø—É—Å–∫ –≤ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª—ã:

**PurserHub/.env:**
```env
BOT_TOKEN=your_telegram_bot_token
API_ID=your_telegram_api_id
API_HASH=your_telegram_api_hash
```

**workers_service/.env:**
```env
API_ID=same_as_above
API_HASH=same_as_above
```

> **–í–∞–∂–Ω–æ**: `API_ID` –∏ `API_HASH` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –≤–æ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö!

### 2. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

–ò–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `PurserHub`:

```bash
# –°–æ–∑–¥–∞—Ç—å shared volume (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
docker volume create shared_sessions

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker compose logs -f parserhub
docker compose logs -f workers-service
docker compose logs -f realty-monitor
```

### 3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ
docker compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
docker compose restart parserhub

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞
docker compose up -d --build
```

---

## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.11+
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

### –ó–∞–ø—É—Å–∫

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1 - Workers Service
cd /home/alex/PycharmProjects/workers_service
python -m pip install -r requirements.txt
python api.py

# –¢–µ—Ä–º–∏–Ω–∞–ª 2 - Realty Monitor
cd /home/alex/PycharmProjects/parser_avito_cian
python -m pip install -r requirements.txt
uvicorn api:app --host 0.0.0.0 --port 8009

# –¢–µ—Ä–º–∏–Ω–∞–ª 3 - PurserHub
cd /home/alex/PycharmProjects/PurserHub
python -m pip install -r requirements.txt
python -m parserhub.bot
```

**–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞** –æ–±–Ω–æ–≤–∏—Ç–µ `.env` –≤ PurserHub:
```env
WORKERS_SERVICE_URL=http://localhost:8002
REALTY_SERVICE_URL=http://localhost:8009
SESSIONS_DIR=./data/sessions
DB_PATH=./data/bot.db
LOG_PATH=./logs/bot.log
```

---

## –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
–û—Ç–∫—Ä–æ–π—Ç–µ Telegram, –Ω–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`

### 2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Telegram –∞–∫–∫–∞—É–Ω—Ç–∞
1. –ù–∞–∂–º–∏—Ç–µ **üë§ –ú–æ–π –∞–∫–∫–∞—É–Ω—Ç**
2. –í—ã–±–µ—Ä–∏—Ç–µ **üîë –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–∞ –ü–í–ó** (–¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤–∞–∫–∞–Ω—Å–∏–π)
3. –í—ã–±–µ—Ä–∏—Ç–µ **üîë –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ß–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞** (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
4. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—Ñ–æ—Ä–º–∞—Ç: `+79991234567`)
5. **–í–ê–ñ–ù–û**: –ù–µ –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∫–æ–¥–æ–º –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º Telegram! –ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ –±–æ—Ç–∞.

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —á–∞—Ç—ã (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
1. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–±—è –≤ —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –≤ –ë–î –∏–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–¥
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É **üìù –ß–∞—Ç—ã –ü–í–ó**
3. –í–≤–µ–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–ø–æ –æ–¥–Ω–æ–º—É –≤ —Å—Ç—Ä–æ–∫–µ):
   ```
   @pvz_vacancy
   @pvz_workers
   @pvz_jobs
   ```
4. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ **üìù –ß–∞—Ç—ã –ß–°**

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **üë∑ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ü–í–ó** ‚Üí –í—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º (–†–∞–±–æ—Ç–Ω–∏–∫–∏/–†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–∏) ‚Üí –í–≤–µ—Å—Ç–∏ –¥–∞—Ç—ã –∏ —Å—Ç–∞–≤–∫–∏
- **üè† –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å** ‚Üí –í—ã–±—Ä–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ (Avito/Cian) ‚Üí –í–≤–µ—Å—Ç–∏ —Å—Å—ã–ª–∫—É —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

> **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ —ç—Ç–æ—Ç –∂–µ —á–∞—Ç** –æ—Ç –±–æ—Ç–∞ PurserHub (–±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–µ –±–æ—Ç—ã)

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# Workers Service - health check
curl http://localhost:8002/health

# Realty Monitor - health check
curl http://localhost:8009/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏
curl http://localhost:8002/workers/status/{task_id}
curl http://localhost:8009/parse/status/{task_id}
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# Docker
docker logs -f parserhub
docker logs -f workers-service
docker logs -f realty-monitor

# –õ–æ–∫–∞–ª—å–Ω–æ
tail -f PurserHub/logs/bot.log
tail -f workers_service/data/logs/workers_service.log
tail -f parser_avito_cian/logs/parser.log
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î (PurserHub)

- **users** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞
- **user_settings** ‚Äî –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (default_mode)
- **global_config** ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
  - `pvz_monitoring_chats` ‚Äî —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ü–í–ó
  - `blacklist_chats` ‚Äî —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –¥–ª—è —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
- **active_tasks** ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞/–ø–∞—Ä—Å–∏–Ω–≥–∞
- **subscriptions** ‚Äî –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **admins** ‚Äî —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

---

## Troubleshooting

### ‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Pyrogram
**–°–∏–º–ø—Ç–æ–º**: "–ö–æ–¥ –±—ã–ª –≤–≤–µ–¥–µ–Ω –≤–µ—Ä–Ω–æ, –Ω–æ –≤—Ö–æ–¥ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω"

**–†–µ—à–µ–Ω–∏–µ**:
1. **–ù–ï –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∫–æ–¥–æ–º –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º Telegram!
2. –ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ –±–æ—Ç–∞
3. –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `API_ID` –∏ `API_HASH` —Å–æ–≤–ø–∞–¥–∞—é—Ç –≤–æ –≤—Å–µ—Ö `.env` —Ñ–∞–π–ª–∞—Ö

### ‚ùå –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
**–°–∏–º–ø—Ç–æ–º**: –û—à–∏–±–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
docker compose ps

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose logs workers-service
docker compose logs realty-monitor

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç—å
docker network inspect parserhub_parserhub_network
```

### ‚ùå –ß–∞—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
**–°–∏–º–ø—Ç–æ–º**: "–ß–∞—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã"

**–†–µ—à–µ–Ω–∏–µ**:
1. –í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º)
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —á–∞—Ç—ã —á–µ—Ä–µ–∑ **üìù –ß–∞—Ç—ã –ü–í–ó**
3. –ß–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ `@username` (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)

### ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã (`docker compose ps`)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ –æ—à–∏–±–∫–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `WORKERS_SERVICE_URL` –∏ `REALTY_SERVICE_URL` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤ `.env`
4. –í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç **–æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞ PurserHub** –≤ –≤–∞—à —á–∞—Ç

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ PurserHub
docker compose restart parserhub

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ volumes
docker volume ls

# –û—á–∏—Å—Ç–∏—Ç—å shared_sessions (—Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
docker volume rm parserhub_shared_sessions

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –≤—Å–µ –æ–±—Ä–∞–∑—ã
docker compose build --no-cache

# –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
docker exec -it parserhub bash
docker exec -it workers-service bash
docker exec -it realty-monitor bash
```
